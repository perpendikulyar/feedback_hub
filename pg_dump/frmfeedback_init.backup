--
-- PostgreSQL database dump
--

-- Dumped from database version 11.5
-- Dumped by pg_dump version 11.5

-- Started on 2019-11-01 18:14:13 MSK

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 3001 (class 1262 OID 16384)
-- Name: frmfeedback; Type: DATABASE; Schema: -; Owner: postgres
--

CREATE DATABASE frmfeedback WITH TEMPLATE = template0 ENCODING = 'UTF8' LC_COLLATE = 'en_US.utf8' LC_CTYPE = 'en_US.utf8';


ALTER DATABASE frmfeedback OWNER TO postgres;

\connect frmfeedback

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 612 (class 1247 OID 16430)
-- Name: problem_status_enum; Type: TYPE; Schema: public; Owner: postgres
--

CREATE TYPE public.problem_status_enum AS ENUM (
    'new',
    'skipped',
    'to_do',
    'resolved'
);


ALTER TYPE public.problem_status_enum OWNER TO postgres;

--
-- TOC entry 615 (class 1247 OID 16440)
-- Name: problem_type_enum; Type: TYPE; Schema: public; Owner: postgres
--

CREATE TYPE public.problem_type_enum AS ENUM (
    'not_set',
    'forms',
    'advertisement',
    'likes',
    'misprint'
);


ALTER TYPE public.problem_type_enum OWNER TO postgres;

--
-- TOC entry 596 (class 1247 OID 16386)
-- Name: system_user_role_enum; Type: TYPE; Schema: public; Owner: postgres
--

CREATE TYPE public.system_user_role_enum AS ENUM (
    'super_admin',
    'api_user'
);


ALTER TYPE public.system_user_role_enum OWNER TO postgres;

--
-- TOC entry 599 (class 1247 OID 16392)
-- Name: system_user_status_enum; Type: TYPE; Schema: public; Owner: postgres
--

CREATE TYPE public.system_user_status_enum AS ENUM (
    'inactive',
    'active'
);


ALTER TYPE public.system_user_status_enum OWNER TO postgres;

SET default_tablespace = '';

SET default_with_oids = false;

--
-- TOC entry 199 (class 1259 OID 16419)
-- Name: author; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.author (
    id integer NOT NULL,
    "authorHash" character varying NOT NULL,
    "systemUserId" integer NOT NULL
);


ALTER TABLE public.author OWNER TO postgres;

--
-- TOC entry 198 (class 1259 OID 16417)
-- Name: author_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.author_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.author_id_seq OWNER TO postgres;

--
-- TOC entry 3002 (class 0 OID 0)
-- Dependencies: 198
-- Name: author_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.author_id_seq OWNED BY public.author.id;


--
-- TOC entry 201 (class 1259 OID 16453)
-- Name: problem; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.problem (
    id integer NOT NULL,
    title character varying NOT NULL,
    description character varying NOT NULL,
    status public.problem_status_enum DEFAULT 'new'::public.problem_status_enum NOT NULL,
    type public.problem_type_enum DEFAULT 'not_set'::public.problem_type_enum NOT NULL,
    "creationDate" timestamp without time zone DEFAULT now() NOT NULL,
    "lastUpdateDate" timestamp without time zone DEFAULT now() NOT NULL,
    "authorId" integer NOT NULL,
    "systemUserId" integer NOT NULL,
    "authorIp" character varying NOT NULL,
    "authorUserAgent" character varying NOT NULL
);


ALTER TABLE public.problem OWNER TO postgres;

--
-- TOC entry 200 (class 1259 OID 16451)
-- Name: problem_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.problem_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.problem_id_seq OWNER TO postgres;

--
-- TOC entry 3003 (class 0 OID 0)
-- Dependencies: 200
-- Name: problem_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.problem_id_seq OWNED BY public.problem.id;


--
-- TOC entry 203 (class 1259 OID 16472)
-- Name: review; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.review (
    id integer NOT NULL,
    text character varying NOT NULL,
    rating integer DEFAULT 0 NOT NULL,
    category character varying,
    "creationDate" timestamp without time zone DEFAULT now() NOT NULL,
    "authorId" integer NOT NULL,
    "systemUserId" integer NOT NULL,
    "authorIp" character varying NOT NULL,
    "authorUserAgent" character varying NOT NULL,
    CONSTRAINT "CHK_cd5d6989c099fbf3c68a7cf387" CHECK (((rating >= 0) AND (rating <= 5)))
);


ALTER TABLE public.review OWNER TO postgres;

--
-- TOC entry 202 (class 1259 OID 16470)
-- Name: review_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.review_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.review_id_seq OWNER TO postgres;

--
-- TOC entry 3004 (class 0 OID 0)
-- Dependencies: 202
-- Name: review_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.review_id_seq OWNED BY public.review.id;


--
-- TOC entry 197 (class 1259 OID 16399)
-- Name: system_user; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.system_user (
    id integer NOT NULL,
    email character varying NOT NULL,
    username character varying NOT NULL,
    password character varying NOT NULL,
    salt character varying NOT NULL,
    "creationDate" timestamp without time zone DEFAULT now() NOT NULL,
    "lastAuthDate" timestamp without time zone NOT NULL,
    role public.system_user_role_enum DEFAULT 'api_user'::public.system_user_role_enum NOT NULL,
    status public.system_user_status_enum DEFAULT 'active'::public.system_user_status_enum NOT NULL
);


ALTER TABLE public.system_user OWNER TO postgres;

--
-- TOC entry 196 (class 1259 OID 16397)
-- Name: system_user_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.system_user_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.system_user_id_seq OWNER TO postgres;

--
-- TOC entry 3005 (class 0 OID 0)
-- Dependencies: 196
-- Name: system_user_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.system_user_id_seq OWNED BY public.system_user.id;


--
-- TOC entry 2828 (class 2604 OID 16422)
-- Name: author id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.author ALTER COLUMN id SET DEFAULT nextval('public.author_id_seq'::regclass);


--
-- TOC entry 2829 (class 2604 OID 16456)
-- Name: problem id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.problem ALTER COLUMN id SET DEFAULT nextval('public.problem_id_seq'::regclass);


--
-- TOC entry 2834 (class 2604 OID 16475)
-- Name: review id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.review ALTER COLUMN id SET DEFAULT nextval('public.review_id_seq'::regclass);


--
-- TOC entry 2824 (class 2604 OID 16402)
-- Name: system_user id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.system_user ALTER COLUMN id SET DEFAULT nextval('public.system_user_id_seq'::regclass);


--
-- TOC entry 2991 (class 0 OID 16419)
-- Dependencies: 199
-- Data for Name: author; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.author (id, "authorHash", "systemUserId") FROM stdin;
\.


--
-- TOC entry 2993 (class 0 OID 16453)
-- Dependencies: 201
-- Data for Name: problem; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.problem (id, title, description, status, type, "creationDate", "lastUpdateDate", "authorId", "systemUserId", "authorIp", "authorUserAgent") FROM stdin;
\.


--
-- TOC entry 2995 (class 0 OID 16472)
-- Dependencies: 203
-- Data for Name: review; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.review (id, text, rating, category, "creationDate", "authorId", "systemUserId", "authorIp", "authorUserAgent") FROM stdin;
\.


--
-- TOC entry 2989 (class 0 OID 16399)
-- Dependencies: 197
-- Data for Name: system_user; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.system_user (id, email, username, password, salt, "creationDate", "lastAuthDate", role, status) FROM stdin;
2	mnikolashin@woman.ru	Michael Nikolashin	$2a$10$GrByKzXMncY1GDw39BB6XuI29Ed9h6JCXlgPL0YiE5lAPHnCiClfK	$2a$10$GrByKzXMncY1GDw39BB6Xu	2019-11-01 17:14:13.059875	2019-11-01 17:14:18.254	super_admin	active
1	test@example.ru	superAdmin	$2a$10$C/07wkpx60UfnxsEEEVxseaqBdtysKA1UgULZtipVTPTGClQSqL6W	$2a$10$C/07wkpx60UfnxsEEEVxse	2019-11-01 17:05:45.891875	2019-11-01 17:05:59.689	super_admin	inactive
\.


--
-- TOC entry 3006 (class 0 OID 0)
-- Dependencies: 198
-- Name: author_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.author_id_seq', 1, false);


--
-- TOC entry 3007 (class 0 OID 0)
-- Dependencies: 200
-- Name: problem_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.problem_id_seq', 1, false);


--
-- TOC entry 3008 (class 0 OID 0)
-- Dependencies: 202
-- Name: review_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.review_id_seq', 1, false);


--
-- TOC entry 3009 (class 0 OID 0)
-- Dependencies: 196
-- Name: system_user_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.system_user_id_seq', 2, true);


--
-- TOC entry 2854 (class 2606 OID 16465)
-- Name: problem PK_119b5ca6f3371465bf1f0f90219; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.problem
    ADD CONSTRAINT "PK_119b5ca6f3371465bf1f0f90219" PRIMARY KEY (id);


--
-- TOC entry 2861 (class 2606 OID 16483)
-- Name: review PK_2e4299a343a81574217255c00ca; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.review
    ADD CONSTRAINT "PK_2e4299a343a81574217255c00ca" PRIMARY KEY (id);


--
-- TOC entry 2848 (class 2606 OID 16427)
-- Name: author PK_5a0e79799d372fe56f2f3fa6871; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.author
    ADD CONSTRAINT "PK_5a0e79799d372fe56f2f3fa6871" PRIMARY KEY (id);


--
-- TOC entry 2843 (class 2606 OID 16410)
-- Name: system_user PK_9949334be1756656fab9fac4a0c; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.system_user
    ADD CONSTRAINT "PK_9949334be1756656fab9fac4a0c" PRIMARY KEY (id);


--
-- TOC entry 2845 (class 2606 OID 16412)
-- Name: system_user UQ_741d321efeff6cfdf96dce44f85; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.system_user
    ADD CONSTRAINT "UQ_741d321efeff6cfdf96dce44f85" UNIQUE (email);


--
-- TOC entry 2855 (class 1259 OID 16486)
-- Name: IDX_0ebaeb8931c9c5f4667fc5be0a; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_0ebaeb8931c9c5f4667fc5be0a" ON public.review USING btree ("creationDate");


--
-- TOC entry 2856 (class 1259 OID 16488)
-- Name: IDX_16df4aed1da95ccb1f07e875f4; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_16df4aed1da95ccb1f07e875f4" ON public.review USING btree ("systemUserId");


--
-- TOC entry 2857 (class 1259 OID 16487)
-- Name: IDX_1e758e3895b930ccf269f30c41; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_1e758e3895b930ccf269f30c41" ON public.review USING btree ("authorId");


--
-- TOC entry 2838 (class 1259 OID 16415)
-- Name: IDX_277c19302411a0b6a1911a076f; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_277c19302411a0b6a1911a076f" ON public.system_user USING btree (role);


--
-- TOC entry 2849 (class 1259 OID 16468)
-- Name: IDX_3110b43be6e5420ddbff44a3fa; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_3110b43be6e5420ddbff44a3fa" ON public.problem USING btree ("systemUserId");


--
-- TOC entry 2839 (class 1259 OID 16416)
-- Name: IDX_33c0aa218c0a5f02286af5b612; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_33c0aa218c0a5f02286af5b612" ON public.system_user USING btree (status);


--
-- TOC entry 2858 (class 1259 OID 16484)
-- Name: IDX_4078f2e08ec084893d3355d05c; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_4078f2e08ec084893d3355d05c" ON public.review USING btree (rating);


--
-- TOC entry 2859 (class 1259 OID 16485)
-- Name: IDX_4c0c65f0d92f6b4a98329fd9d3; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_4c0c65f0d92f6b4a98329fd9d3" ON public.review USING btree (category);


--
-- TOC entry 2846 (class 1259 OID 16428)
-- Name: IDX_6444b93693bfed63da64e5df32; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_6444b93693bfed63da64e5df32" ON public.author USING btree ("authorHash");


--
-- TOC entry 2840 (class 1259 OID 16414)
-- Name: IDX_65cece187412e1eb90a5d5373c; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_65cece187412e1eb90a5d5373c" ON public.system_user USING btree (username);


--
-- TOC entry 2850 (class 1259 OID 16469)
-- Name: IDX_6bc098e4c6ff96e2961d8208f2; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_6bc098e4c6ff96e2961d8208f2" ON public.problem USING btree (title, description);


--
-- TOC entry 2841 (class 1259 OID 16413)
-- Name: IDX_741d321efeff6cfdf96dce44f8; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX "IDX_741d321efeff6cfdf96dce44f8" ON public.system_user USING btree (email);


--
-- TOC entry 2851 (class 1259 OID 16466)
-- Name: IDX_c2eb782a7a83433ed25c1f09d0; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_c2eb782a7a83433ed25c1f09d0" ON public.problem USING btree (status);


--
-- TOC entry 2852 (class 1259 OID 16467)
-- Name: IDX_cdc626ab8f328c721ae0682209; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX "IDX_cdc626ab8f328c721ae0682209" ON public.problem USING btree (type);


--
-- TOC entry 2863 (class 2606 OID 16494)
-- Name: problem FK_0844a469891a47f6d71f19632df; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.problem
    ADD CONSTRAINT "FK_0844a469891a47f6d71f19632df" FOREIGN KEY ("authorId") REFERENCES public.author(id);


--
-- TOC entry 2866 (class 2606 OID 16509)
-- Name: review FK_16df4aed1da95ccb1f07e875f4b; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.review
    ADD CONSTRAINT "FK_16df4aed1da95ccb1f07e875f4b" FOREIGN KEY ("systemUserId") REFERENCES public.system_user(id);


--
-- TOC entry 2865 (class 2606 OID 16504)
-- Name: review FK_1e758e3895b930ccf269f30c415; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.review
    ADD CONSTRAINT "FK_1e758e3895b930ccf269f30c415" FOREIGN KEY ("authorId") REFERENCES public.author(id);


--
-- TOC entry 2864 (class 2606 OID 16499)
-- Name: problem FK_3110b43be6e5420ddbff44a3faa; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.problem
    ADD CONSTRAINT "FK_3110b43be6e5420ddbff44a3faa" FOREIGN KEY ("systemUserId") REFERENCES public.system_user(id);


--
-- TOC entry 2862 (class 2606 OID 16489)
-- Name: author FK_342926ac8fae7d93c95da7706ce; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.author
    ADD CONSTRAINT "FK_342926ac8fae7d93c95da7706ce" FOREIGN KEY ("systemUserId") REFERENCES public.system_user(id);


-- Completed on 2019-11-01 18:14:21 MSK

--
-- PostgreSQL database dump complete
--

